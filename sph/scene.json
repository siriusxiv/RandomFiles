{"nodeData":[{"name":"LoadSPH","funcname":"LoadSPH","info":"SPHファイルを読み込むためのノード","pos":[201.5,185.5],"varname":"instSPHLoader1","customfuncfile":"sphloader.lua","input":[{"name":"filepath","type":"string","value":"HEARTT001.sph"}],"output":[{"name":"VolumeData","type":"BufferVolumeData"},{"name":"Width","type":"float"},{"name":"Height","type":"float"},{"name":"Depth","type":"float"},{"name":"Component","type":"float"}],"customfunc":"function LoadSPH(property)\n\tlocal sphloader\n\tsphloader = SPHLoader()\n\tsphloader:Load(property.filepath)\n\treturn sphloader\nend\n"},{"name":"CreateCamera","funcname":"CreateCamera","info":"カメラをつくるためのノード","pos":[253.5,14.5],"varname":"instCreateCamera2","customfuncfile":"createcamera.lua","input":[{"name":"position","type":"vec3","value":["0","1300","10"]},{"name":"target","type":"vec3","value":["0","0",0]},{"name":"up","type":"vec3","value":["1","0",0]},{"name":"fov","type":"float","value":"70"},{"name":"screensize","type":"vec2","value":["1024","1024"]},{"name":"filename","type":"string","value":"output.jpg"}],"output":[{"name":"camera","type":"RenderObject"}],"customfunc":"function CreateCamera(property)\n\tlocal cam;\t\n\tprint('create camera',\n\t\tproperty.screensize[1], property.screensize[2],\n\t\tproperty.filename)\n\tcam = Camera()\n\tcam:SetScreenSize(property.screensize[1], property.screensize[2])\n\tcam:SetFilename(property.filename)\n\tcam:LookAt(\n\t\tproperty.position[1], property.position[2], property.position[3],\n\t\tproperty.target[1], property.target[2], property.target[3],\n\t\tproperty.up[1], property.up[2], property.up[3],\n\t\tproperty.fov\n\t)\n\t\n\tfunction camera()\n\t\treturn cam\n\tend\n\treturn {\n\t\tcamera = camera\n\t}\nend\n"},{"name":"CreateVolumeModel","funcname":"CreateVolumeModel","info":"Volumeデータを表示させるためのノード","pos":[911.5,179.5],"varname":"instVolumeModel3","customfuncfile":"createVolumeModel.lua","input":[{"name":"volume","type":"BufferVolumeData"},{"name":"translate","type":"vec3","value":["0",0,0]},{"name":"rotate","type":"vec3","value":["0",0,0]},{"name":"scale","type":"vec3","value":["1","1","1"]},{"name":"shadername","type":"string","value":"def_volume_raymarch.frag"},{"name":"Uniform","type":"Uniform","array":[{"name":"Uniform0","type":"Uniform"},{"name":"Uniform1","type":"Uniform"},{"name":"Uniform2","type":"Uniform"}]}],"output":[{"name":"model","type":"RenderObject"}],"customfunc":"function CreateVolumeModel(property)\n\tlocal vm = VolumeModel();\n\tvm:Create(property.volume);\n\tvm:SetTranslate(property.translate[1], property.translate[2], property.translate[3])\n\tvm:SetRotate(property.rotate[1], property.rotate[2], property.rotate[3])\n\tvm:SetScale(property.scale[1], property.scale[2], property.scale[3])\n\tvm:SetShader(property.shadername)\n\tlocal uniforms = property.Uniform\n\tfor i,v in pairs(uniforms) do\n\t\tif v.type == 'vec4' then\n\t\t\tprint('vec4[' .. v.name .. '] = (', v.value[1], v.value[2], v.value[3], v.value[4], ')')\n\t\t\tvm:SetVec4(v.name, v.value[1], v.value[2], v.value[3], v.value[4])\n\t\tend\n\t\tif v.type == 'vec3' then\n\t\t\tprint('vec3[' .. v.name .. '] = (', v.value[1], v.value[2], v.value[3], ')')\n\t\t\tvm:SetVec3(v.name, v.value[1], v.value[2], v.value[3])\n\t\tend\n\t\tif v.type == 'vec2' then\n\t\t\tprint('vec2[' .. v.name .. '] = (', v.value[1], v.value[2], ')')\n\t\t\tvm:SetVec2(v.name, v.value[1], v.value[2])\n\t\tend\n\t\tif v.type == 'float' then\n\t\t\tprint('float[' .. v.name .. '] = (', v.value, ')')\n\t\t\tvm:SetFloat(v.name, v.value)\n\t\tend\n\tend\n\tfunction getModel()\n\t\treturn vm\n\tend\n\treturn {\n\t\tmodel=getModel\n\t}\nend\n"},{"name":"Render","funcname":"Render","info":"レンダリングを行うためのノード","pos":[1186.5,53.5],"varname":"root4","customfuncfile":"render.lua","rootnode":true,"input":[{"name":"RenderObject","type":"RenderObject","array":[{"name":"RenderObject0","type":"RenderObject"},{"name":"RenderObject1","type":"RenderObject"}]}],"output":[],"customfunc":"function Render(arg)\n\trender(arg.RenderObject)\nend"},{"name":"UniformFloat","funcname":"UniformFloat","info":"Uniform Floatをつくるノード","pos":[566.5,227.5],"varname":"instUniformFloat5","customfuncfile":"float.lua","input":[{"name":"name","type":"string","value":"width"},{"name":"val","type":"float","value":0}],"output":[{"name":"uniform","type":"Uniform"}],"customfunc":"function UniformFloat(arg)\n\tlocal name = arg.name\n\tlocal val  = arg.val\n\treturn {\n\t\tuniform = function()\n\t\t\treturn {name=name, value=val, type='float'}\n\t\tend\n\t}\nend"},{"name":"UniformFloat","funcname":"UniformFloat","info":"Uniform Floatをつくるノード","pos":[570.5,329.5],"varname":"instUniformFloat6","customfuncfile":"float.lua","input":[{"name":"name","type":"string","value":"height"},{"name":"val","type":"float","value":0}],"output":[{"name":"uniform","type":"Uniform"}],"customfunc":"function UniformFloat(arg)\n\tlocal name = arg.name\n\tlocal val  = arg.val\n\treturn {\n\t\tuniform = function()\n\t\t\treturn {name=name, value=val, type='float'}\n\t\tend\n\t}\nend"},{"name":"UniformFloat","funcname":"UniformFloat","info":"Uniform Floatをつくるノード","pos":[569.5,426.5],"varname":"instUniformFloat7","customfuncfile":"float.lua","input":[{"name":"name","type":"string","value":"depth"},{"name":"val","type":"float","value":0}],"output":[{"name":"uniform","type":"Uniform"}],"customfunc":"function UniformFloat(arg)\n\tlocal name = arg.name\n\tlocal val  = arg.val\n\treturn {\n\t\tuniform = function()\n\t\t\treturn {name=name, value=val, type='float'}\n\t\tend\n\t}\nend"}],"plugData":[{"output":{"node":"instSPHLoader1","plug":"VolumeData"},"input":{"node":"instVolumeModel3","plug":"volume"}},{"output":{"node":"instVolumeModel3","plug":"model"},"input":{"node":"root4","plug":"RenderObject1"}},{"output":{"node":"instCreateCamera2","plug":"camera"},"input":{"node":"root4","plug":"RenderObject0"}},{"output":{"node":"instSPHLoader1","plug":"Width"},"input":{"node":"instUniformFloat5","plug":"val"}},{"output":{"node":"instSPHLoader1","plug":"Depth"},"input":{"node":"instUniformFloat7","plug":"val"}},{"output":{"node":"instUniformFloat5","plug":"uniform"},"input":{"node":"instVolumeModel3","plug":"Uniform0"}},{"output":{"node":"instUniformFloat6","plug":"uniform"},"input":{"node":"instVolumeModel3","plug":"Uniform1"}},{"output":{"node":"instUniformFloat7","plug":"uniform"},"input":{"node":"instVolumeModel3","plug":"Uniform2"}},{"output":{"node":"instSPHLoader1","plug":"Height"},"input":{"node":"instUniformFloat6","plug":"val"}}]}